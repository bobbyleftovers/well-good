(function(t){function n(n){for(var i,a,r=n[0],c=n[1],u=n[2],l=0,p=[];l<r.length;l++)a=r[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(n);while(p.length)p.shift()();return s.push.apply(s,u||[]),e()}function e(){for(var t,n=0;n<s.length;n++){for(var e=s[n],i=!0,r=1;r<e.length;r++){var c=e[r];0!==o[c]&&(i=!1)}i&&(s.splice(n--,1),t=a(a.s=e[0]))}return t}var i={},o={app:0},s=[];function a(n){if(i[n])return i[n].exports;var e=i[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=t,a.c=i,a.d=function(t,n,e){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)a.d(e,i,function(n){return t[n]}.bind(null,i));return e},a.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="/wp-content/plugins/wg-varnish/dist/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=n,r=r.slice();for(var u=0;u<r.length;u++)n(r[u]);var d=c;s.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("56d7")},"06b5":function(t,n,e){},"3e25":function(t,n,e){"use strict";var i=e("887e"),o=e.n(i);o.a},"49f7":function(t,n,e){"use strict";var i=e("06b5"),o=e.n(i);o.a},"56d7":function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var i=e("2b0e"),o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"poststuff"}},[e("CustomPurge")],1)},s=[],a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"custom-purge"},[t.notification?e("div",{staticClass:"notice",class:t.notification.type},[e("p",[e("span",{domProps:{innerHTML:t._s(t.notification.text)}}),t._v(". ")]),e("span",{staticClass:"dashicons dashicons-dismiss",on:{click:function(n){t.notification=!1}}})]):t._e(),e("div",{staticClass:"postbox wp-metabox"},[t._m(0),e("div",{staticClass:"inside custom-purge__body"},[t._l(t.endpoints,(function(n){return e("PurgeEndpoint",{key:n.id,attrs:{endpoints:t.endpoints,endpoint:n,key2:n.id,root:t.root},on:{input:t.onInput,remove:t.remove}})})),e("div",{staticClass:"custom-purge__row custom-purge__row--add-new",on:{click:t.add}},[e("span",{staticClass:"dashicons dashicons-plus-alt"}),t._v(" Add endpoint ")]),e("button",{staticClass:"button button-primary button-hero custom-purge__submit",on:{click:t.submit}},[t._v("Purge now")])],2),t.is_loading?e("Loading"):t._e()],1)])},r=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("h2",{staticClass:"hndle"},[e("span",[t._v("Purge urls")])])}],c=(e("99af"),e("4160"),e("caad"),e("a434"),e("b64b"),e("d3b7"),e("ac1f"),e("5319"),e("159b"),e("53ca")),u=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"custom-purge__endpoint"},[e("div",{staticClass:"custom-purge__row"},[e("span",{staticClass:"custom-purge__input-prepend"},[t._v(t._s(t.root))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.main,expression:"main"}],staticClass:"custom-purge__input",domProps:{value:t.main},on:{input:function(n){n.target.composing||(t.main=n.target.value)}}})]),t.endpoints.length>1?e("div",{key:t.key2,staticClass:"custom-purge__remove button button-secondary",on:{click:function(n){return t.remove()}}}):t._e(),e("div",{staticClass:"custom-purge__input-append"},[e("multiselect",{attrs:{"select-label":"Add","deselect-label":"Remove","show-labels":!0,"tag-placeholder":"Add this as new tag",placeholder:"Additional endpoints",label:"name","track-by":"code",options:t.options,multiple:!0,taggable:!0,searchable:!1},model:{value:t.additional,callback:function(n){t.additional=n},expression:"additional"}})],1)])])},d=[],l=e("8e5f"),p=e.n(l),f={components:{Multiselect:p.a},props:["root","endpoint","endpoints","key2"],data:function(){return{main:"",additional:[],options:[{name:"amp",code:"/amp"},{name:"feed",code:"/feed"}]}},watch:{additional:function(){this.emit()},main:function(){this.emit()}},methods:{emit:function(){var t=this,n=[this.main];this.additional.forEach((function(e){n.push(t.main+e.code)})),this.$emit("input",{key:this.key2,urls:n})},remove:function(){this.$emit("remove",this.key2)}}},h=f,m=(e("49f7"),e("72c2"),e("2877")),v=Object(m["a"])(h,u,d,!1,null,"0f720c3e",null),b=v.exports,g=e("1ace"),_={components:{PurgeEndpoint:b},data:function(){return{is_loading:!1,endpoints:[{id:Date.now(),urls:[""]}],notification:!1}},computed:{root:function(){return window.location.origin+"/"},reduced_endpoints:function(){var t=[];return this.endpoints.forEach((function(n){var e=n.urls;"object"!==Object(c["a"])(e)&&(e=[""]),e.forEach((function(n){n=("/"+n+"/").replace("//","/"),t.includes(n)||t.push(n)}))})),t}},methods:{onInput:function(t){var n=this;"object"!==Object(c["a"])(t.urls)&&(t.urls=[""]),this.endpoints.forEach((function(e,i){e.id===t.key&&(n.endpoints[i].urls=t.urls)})),this.endpoints=Object.assign([],this.endpoints)},add:function(){var t=this;this.endpoints.push({id:Date.now(),urls:[""]}),this.$nextTick((function(){g["a"].last(".custom-purge__input",t.$el).focus()}))},submit:function(){var t=this;this.is_loading=!0,console.log("%c Purging Varnish ","background: #222; color: #bada55"),console.log(this.reduced_endpoints),fetch(window.WG_Varnish_REST_Purge.purge_urls,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:this.reduced_endpoints})}).then((function(t){return t.json()})).then((function(n){var e="",i=0;Object.keys(n).forEach((function(t){e+="<pre>".concat(t,"</pre>"),i++})),t.notification=Object.assign({},{text:"Purged <strong>".concat(t.reduced_endpoints.length,"</strong> urls in ").concat(i," servers: ").concat(e),type:"notice-success"})})).catch((function(n){t.notification=Object.assign({},{text:"Awghh! Something went wrong...",type:"error"}),console.error(n)})).then((function(){t.is_loading=!1}))},remove:function(t){var n=this;this.endpoints.forEach((function(e,i){e.id===t&&n.endpoints.splice(i,1)})),this.endpoints=Object.assign([],this.endpoints)}}},y=_,w=(e("e88b"),e("67c5"),Object(m["a"])(y,a,r,!1,null,"a7dd6b4a",null)),O=w.exports,j={components:{CustomPurge:O}},k=j,C=(e("3e25"),Object(m["a"])(k,o,s,!1,null,"42b34bdb",null)),P=C.exports,x=(e("b107"),function(){var t=this,n=t.$createElement;t._self._c;return t._m(0)}),E=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"loading"},[e("div",{staticClass:"spinner is-active"})])}],$=(e("79ec"),{}),S=Object(m["a"])($,x,E,!1,null,"44888678",null),T=S.exports;i["a"].component("Loading",T),i["a"].config.productionTip=!1,document.addEventListener("DOMContentLoaded",(function(){new i["a"]({render:function(t){return t(P)}}).$mount(".wg-varnish-admin-page__content")}))},5817:function(t,n,e){},"67c5":function(t,n,e){"use strict";var i=e("5817"),o=e.n(i);o.a},"72c2":function(t,n,e){"use strict";var i=e("d384"),o=e.n(i);o.a},"79ec":function(t,n,e){"use strict";var i=e("b685"),o=e.n(i);o.a},"817f":function(t,n,e){},"887e":function(t,n,e){},b107:function(t,n,e){},b685:function(t,n,e){},d384:function(t,n,e){},e88b:function(t,n,e){"use strict";var i=e("817f"),o=e.n(i);o.a}});